local Rayfield = loadstring(game:HttpGet("https://sirius.menu/rayfield"))()

local Window = Rayfield:CreateWindow({
    Name = "My Asta Hub",
    LoadingTitle = "Loading...",
    LoadingSubtitle = "By Dev",
    ConfigurationSaving = {
        Enabled = false,
        FolderName = nil,
        FileName = "AstaHub"
    },
    Discord = {
        Enabled = false,
        Invite = "yourdiscordlink",
        RememberJoins = true
    },
    KeySystem = false
})

local FarmTab = Window:CreateTab("Farm", 4483362458)

local selectedAttackType = "Melee"
local autofarmlevel = false
local takequest = true
local currentQuest = nil

FarmTab:CreateDropdown({
    Name = "Select Attack Type",
    Options = {"Melee", "Blox Fruit", "Sword"},
    Default = "Melee",
    Callback = function(value)
        selectedAttackType = value
    end
})

FarmTab:CreateToggle({
    Name = "Auto Farm Level",
    CurrentValue = false,
    Flag = "AutoFarmLevel",
    Callback = function(value)
        autofarmlevel = value
        if autofarmlevel then
            StartAutoFarmLevel()
        end
    end
})

FarmTab:CreateToggle({
    Name = "Take Quest",
    CurrentValue = true,
    Flag = "TakeQuest",
    Callback = function(value)
        takequest = value
    end
})

FarmTab:CreateButton({
    Name = "Redeem All Codes",
    Callback = function()
        ActivateXPCodesAndRefund()
    end
})

function StartAutoFarmLevel()
    while autofarmlevel do
        local player = game.Players.LocalPlayer
        local char = player.Character
        local level = player.Data.Level.Value

        if level >= 2600 then
            print("Max level reached: Stopping auto farm.")
            break
        end

        if char and char:FindFirstChild("HumanoidRootPart") then
            local quest = GetQuestForLevel(level)

            if quest and (not currentQuest or currentQuest.NPC ~= quest.NPC) then
                currentQuest = quest
                if takequest then
                    StartQuest(quest)
                end
            end

            FarmEnemies(quest.EnemyName, selectedAttackType)
        end
        wait(1)
    end
end

function FarmEnemies(enemyName, attackType)
    local player = game.Players.LocalPlayer
    local character = player.Character
    if not character then return end
    local humanoid = character:FindFirstChild("Humanoid")

    if attackType == "Melee" then
        local target = game.Workspace:FindFirstChild(enemyName)
        if target then
            humanoid:MoveTo(target.Position)
            humanoid:Attack(target)
        end
    elseif attackType == "Blox Fruit" then
        local target = game.Workspace:FindFirstChild(enemyName)
        if target then
            player:FindFirstChild("BloxFruitSkill"):UseSkill(target)
        end
    elseif attackType == "Sword" then
        local target = game.Workspace:FindFirstChild(enemyName)
        if target then
            player:FindFirstChild("Sword"):Attack(target)
        end
    end
end

function ActivateXPCodesAndRefund()
    local codes = {
        "EXP_5B", "EXP_4B", "Sub2Fer999", "Enyu_is_Pro",
        "MagicBus", "JCWK", "Starcodeheo", "Bluxxy",
        "fudd10_v2", "SUB2GAMERROBOT_EXP1", "SUB2NOOBMASTER123"
    }

    for _, code in ipairs(codes) do
        game:GetService("ReplicatedStorage").Remotes.Redeem:InvokeServer(code)
        wait(0.5)
    end

    game:GetService("ReplicatedStorage").Remotes.RefundStats:InvokeServer()
end

function GetQuestForLevel(level)
    local quests = {
        {min = 1, max = 14, npc = "Bandit Quest Giver", enemy = "Bandit"},
        {min = 15, max = 29, npc = "Gorilla Quest Giver", enemy = "Gorilla"},
        {min = 30, max = 49, npc = "Pirate Quest Giver", enemy = "Pirate"},
        {min = 50, max = 74, npc = "Brute Quest Giver", enemy = "Brute"},
        {min = 75, max = 89, npc = "Desert Bandit Quest Giver", enemy = "Desert Bandit"},
        {min = 90, max = 119, npc = "Snow Bandit Quest Giver", enemy = "Snow Bandit"},
        {min = 120, max = 149, npc = "Yeti Quest Giver", enemy = "Yeti"},
        {min = 150, max = 174, npc = "Sky Bandit Quest Giver", enemy = "Sky Bandit"},
        {min = 175, max = 189, npc = "Dark Master Quest Giver", enemy = "Dark Master"},
        {min = 190, max = 224, npc = "Prisoner Quest Giver", enemy = "Prisoner"},
        {min = 225, max = 249, npc = "Colosseum Gladiator Quest Giver", enemy = "Gladiator"},
        {min = 250, max = 274, npc = "Marine Captain Quest Giver", enemy = "Marine Captain"},
        {min = 275, max = 299, npc = "Galley Captain Quest Giver", enemy = "Galley Captain"},
        {min = 300, max = 324, npc = "Zombie Quest Giver", enemy = "Zombie"},
        {min = 325, max = 374, npc = "Vampire Quest Giver", enemy = "Vampire"},
        {min = 375, max = 399, npc = "Snowman Quest Giver", enemy = "Snowman"},
        {min = 400, max = 449, npc = "Sky Guardian Quest Giver", enemy = "Sky Guardian"},
        {min = 450, max = 474, npc = "Royal Squad Quest Giver", enemy = "Royal Squad"},
        {min = 475, max = 524, npc = "Fishman Warrior Quest Giver", enemy = "Fishman Warrior"},
        {min = 525, max = 549, npc = "Fishman Commando Quest Giver", enemy = "Fishman Commando"},
        {min = 550, max = 624, npc = "God's Guard Quest Giver", enemy = "God's Guard"},
        {min = 625, max = 674, npc = "Shanda Quest Giver", enemy = "Shanda"},
        {min = 675, max = 699, npc = "Warden Quest Giver", enemy = "Warden"},
        {min = 700, max = 724, npc = "Chief Warden Quest Giver", enemy = "Chief Warden"},
        {min = 725, max = 774, npc = "Swan Pirate Quest Giver", enemy = "Swan Pirate"},
        {min = 775, max = 799, npc = "Marine Rear Admiral Quest Giver", enemy = "Marine Rear Admiral"},
        {min = 800, max = 849, npc = "Magma Ninja Quest Giver", enemy = "Magma Ninja"},
        {min = 850, max = 899, npc = "Sea King Quest Giver", enemy = "Sea King"},
        {min = 900, max = 999, npc = "Ancient Guardian Quest Giver", enemy = "Ancient Guardian"},
        {min = 1000, max = 1499, npc = "Legendary Warrior Quest Giver", enemy = "Legendary Warrior"},
        {min = 1500, max = 1999, npc = "Dark Overlord Quest Giver", enemy = "Dark Overlord"},
        {min = 2000, max = 2599, npc = "Final Boss Quest Giver", enemy = "Final Boss"},
        {min = 2600, max = 2600, npc = "Max Level Quest Giver", enemy = "Max Level Boss"}
    }

    for _, quest in ipairs(quests) do
        if level >= quest.min and level <= quest.max then
            return {NPC = quest.npc, EnemyName = quest.enemy}
        end
    end

    return nil
end
